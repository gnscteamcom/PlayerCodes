jQuery(function ($) {

    jQuery('a#try_now').click(function (){
        $('html, body').animate({
            scrollTop: $('div.apicodes-box').offset().top
        }, 1000);
    });

    jQuery('a#supported_sites').click(function (){
        $('html, body').animate({
            scrollTop: $('div.sites').offset().top
        }, 1000);
    });

	//Add Sub
	jQuery(document).on('click', '#add_new_sub', function(e){

	    e.preventDefault();

	    var num = $(this).data('total');

		var ep = num + 1;

		$(this).data('total', ep);

		var new_sub = '<div id="sub-block">';
		new_sub += '<div class="row">';
		new_sub += '<div class="col-md-3"> <div class="form-group m-0"> <label class="font-weight-bold"></label> <select data-placeholder="Choose a Language..." name="caption[]" class="form-control"> <option value="Afrikaans">Afrikaans</option> <option value="Albanian">Albanian</option> <option value="Arabic">Arabic</option> <option value="Armenian">Armenian</option> <option value="Basque">Basque</option> <option value="Bengali">Bengali</option> <option value="Bulgarian">Bulgarian</option> <option value="Catalan">Catalan</option> <option value="Cambodian">Cambodian</option> <option value="Chinese (Mandarin)">Chinese (Mandarin)</option> <option value="Croatian">Croatian</option> <option value="Czech">Czech</option> <option value="Danish">Danish</option> <option value="Dutch">Dutch</option> <option value="English" selected>English</option> <option value="Estonian">Estonian</option> <option value="Fiji">Fiji</option> <option value="Finnish">Finnish</option> <option value="French">French</option> <option value="Georgian">Georgian</option> <option value="German">German</option> <option value="Greek">Greek</option> <option value="Gujarati">Gujarati</option> <option value="Hebrew">Hebrew</option> <option value="Hindi">Hindi</option> <option value="Hungarian">Hungarian</option> <option value="Icelandic">Icelandic</option> <option value="Indonesian">Indonesian</option> <option value="Irish">Irish</option> <option value="Italian">Italian</option> <option value="Japanese">Japanese</option> <option value="Javanese">Javanese</option> <option value="Korean">Korean</option> <option value="Latin">Latin</option> <option value="Latvian">Latvian</option> <option value="Lithuanian">Lithuanian</option> <option value="Macedonian">Macedonian</option> <option value="Malay">Malay</option> <option value="Malayalam">Malayalam</option> <option value="Maltese">Maltese</option> <option value="Maori">Maori</option> <option value="Marathi">Marathi</option> <option value="Mongolian">Mongolian</option> <option value="Nepali">Nepali</option> <option value="Norwegian">Norwegian</option> <option value="Persian">Persian</option> <option value="Polish">Polish</option> <option value="Portuguese">Portuguese</option> <option value="Punjabi">Punjabi</option> <option value="Quechua">Quechua</option> <option value="Romanian">Romanian</option> <option value="Russian">Russian</option> <option value="Samoan">Samoan</option> <option value="Serbian">Serbian</option> <option value="Slovak">Slovak</option> <option value="Slovenian">Slovenian</option> <option value="Spanish">Spanish</option> <option value="Swahili">Swahili</option> <option value="Swedish ">Swedish </option> <option value="Tamil">Tamil</option> <option value="Tatar">Tatar</option> <option value="Telugu">Telugu</option> <option value="Thai">Thai</option> <option value="Tibetan">Tibetan</option> <option value="Tonga">Tonga</option> <option value="Turkish">Turkish</option> <option value="Ukrainian">Ukrainian</option> <option value="Urdu">Urdu</option> <option value="Uzbek">Uzbek</option> <option value="Vietnamese">Vietnamese</option> <option value="Welsh">Welsh</option> <option value="Xhosa">Xhosa</option> </select> </div> </div>';
		new_sub += '<div class="col-md-7"> <div class="form-group m-0"> <label class="font-weight-bold"></label> <input type="text" class="form-control" id="sub'+ep+'" name="sub[]" onclick="this.select()"> </div> </div>';
		new_sub += '<div class="col-md-1"> <div class="form-group m-0"> <label class="font-weight-bold"></label> <input id="subFile'+ep+'" name="subFile[]" type="file" accept=".srt, .vtt" class="btn btn-info btn-block" data-show-preview="false"> </div> </div>';
		new_sub += '<div class="col-md-1" style="margin-top: 24px"> <button type="button" id="remove_sub" class="btn btn-danger btn-block"><i class="far fa-trash-alt"></i></button> </div>';
		new_sub += '</div></div>';
		
		$('#sub').append(new_sub);

		jQuery('#subFile' + ep).fileinput({
		    theme: 'explorer-fas',
		    uploadUrl:  "upload.php",
		    maxFileSize: 1024,
		    browseClass: "btn btn-block btn-info",
		    allowedFileExtensions: ["srt", "vtt"],
		    layoutTemplates: {progress: ''},
		    browseLabel: '',
		    browseIcon: '<i class="fas fa-upload"></i>',
		    initialPreviewAsData: true,
		    showCaption: false,
		    showCancel: false, 
			showDrag: false,
			showUpload: false,
			showRemove: false,
		}).on("filebatchselected", function(event, files) {
		    jQuery('#subFile' + ep).fileinput("upload");
		}).on('fileuploaded', function(event, data, previewId, index) {
			jQuery('#sub' + ep).val(data.response.initialPreview[index]);
			new PNotify({
			  title: 'Success!',
			  text: 'File uploaded successfully.',
			  type: 'success',
			  icon: ''
			});

		}).on('fileuploaderror', function(event, data, msg) {
			if(data.response) {
				new PNotify({
				  title: 'Error!',
				  text: msg,
				  type: 'error',
				  icon: ''
				});
			}

		});

	});

	//Delete Sub
	$(document).on('click', '#remove_sub', function(e){
	    e.preventDefault();
	    $(this).closest('#sub-block').remove();
	});

})
